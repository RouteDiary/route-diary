<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
                        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.routediary.repository.NoticeImageRepository">
  <select id="selectNoticeImages" parameterType="int" resultType="NoticeImage">
		SELECT *
		FROM notice_images
		WHERE notice_no = #{noticeNo}
  </select>
  
  <insert id="insert" parameterType="NoticeImage">
        INSERT INTO notice_images (notice_no, image_no, file_name, stored_file_path)
             VALUES (#{noticeNo}
                   , (SELECT NVL(MAX(image_no), 0) + 1
        	            FROM notice_images WHERE notice_no = #{noticeNo})
        	       , #{fileName}
        	       , #{storedFilePath})
  </insert>
  
  <delete id="delete" parameterType="int">
        DELETE FROM notice_images 
              WHERE notice_no = #{noticeNo} AND image_no = #{imageNo}
  </delete>

  <delete id="deleteAll" parameterType="int">
        DELETE FROM notice_images 
              WHERE notice_no = #{noticeNo}    
  </delete>
</mapper>